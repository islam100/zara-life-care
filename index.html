<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ambulance Service - Home</title>
  <style>
    body { font-family: Arial, sans-serif; }
    .card { 
      border: 1px solid #ccc; 
      border-radius: 8px; 
      padding: 10px; 
      margin: 10px; 
      display: inline-block; 
      width: 200px; 
      vertical-align: top; 
    }
    .card h3 { margin: 5px 0; }
    .dropdown { padding: 5px; font-size: 12px; }
    button {
      padding: 10px 20px; 
      font-size: 16px; 
      margin: 10px; 
      cursor: pointer; 
      border-radius: 10px;
      border: none;
      background: linear-gradient(145deg, #6cc1ff, #3a8dff);
      box-shadow: 3px 3px 6px #2e7ad1, -3px -3px 6px #78bbff;
      color: white;
      transition: 0.3s ease;
    }
    button:hover {
      box-shadow: inset 3px 3px 6px #2e7ad1, inset -3px -3px 6px #78bbff;
    }
  </style>
</head>
<body>

  <h1>Available Ambulances</h1>
  <button id="loginBtn">Login with Google</button>
  <button id="logoutBtn" style="display:none;">Logout</button>

  <div id="drivers-container">Loading...</div>

  <!-- Firebase Compat SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

  <script>
    // Your Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyCFgRQxK_W2T9S5QWZnxAd-kYV52Kzyb94",
      authDomain: "zara-life-care.firebaseapp.com",
      projectId: "zara-life-care",
      storageBucket: "zara-life-care.appspot.com",
      messagingSenderId: "307306937129",
      appId: "1:307306937129:web:a949207fe87dd3d538"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);

    const auth = firebase.auth();
    const database = firebase.database();

    const loginBtn = document.getElementById('loginBtn');
    const logoutBtn = document.getElementById('logoutBtn');
    const driversContainer = document.getElementById('drivers-container');

    loginBtn.onclick = () => {
      const provider = new firebase.auth.GoogleAuthProvider();
      auth.signInWithPopup(provider).catch(e => alert(e.message));
    };

    logoutBtn.onclick = () => {
      auth.signOut();
    };

    auth.onAuthStateChanged(user => {
      if (user) {
        loginBtn.style.display = 'none';
        logoutBtn.style.display = 'inline-block';
        loadApprovedDrivers();
      } else {
        loginBtn.style.display = 'inline-block';
        logoutBtn.style.display = 'none';
        driversContainer.innerHTML = 'Please login to see available ambulances.';
      }
    });

    function loadApprovedDrivers() {
      driversContainer.innerHTML = 'Loading...';
      database.ref('drivers').orderByChild('status').equalTo('approved').on('value', snapshot => {
        driversContainer.innerHTML = '';
        if (!snapshot.exists()) {
          driversContainer.innerHTML = 'No approved drivers found.';
          return;
        }
        snapshot.forEach(child => {
          const d = child.val();
          driversContainer.innerHTML += `
            <div class="card">
              <h3>${d.name || 'Unknown'}</h3>
              <p>Ambulance No: ${d.ambulanceNo}</p>
              <select class="dropdown">
                <option>Option 1</option>
                <option>Option 2</option>
              </select>
              <select class="dropdown">
                <option>Link 1</option>
                <option>Link 2</option>
              </select>
              <button>Book Ambulance</button>
            </div>
          `;
        });
      });
    }
  </script>

</body>
</html>
